"use strict";class t{constructor(){this.monthNames=["Meskerem","Tikimt","Hidar","Tahsas","Tir","Yekatit","Megabit","Miazia","Ginbot","Sene","Hamle","Nehase","Pagume"],this.monthNamesAmharic=["መስከረም","ጥቅምት","ኅዳር","ታኅሣሥ","ጥር","የካቲት","መጋቢት","ሚያዝያ","ግንቦት","ሰኔ","ሐምሌ","ነሐሴ","ጳጉሜን"],this.dayNames=["Ehud","Segno","Maksegno","Erob","Hamus","Arb","Kidame"],this.dayNamesAmharic=["እሁድ","ሰኞ","ማክሰኞ","ረቡዕ","ሐሙስ","ዓርብ","ቅዳሜ"]}_startDayOfEthiopian(t){const e=Math.floor(t/100)-Math.floor(t/400)-4;return(t-1)%4==3?e+1:e}toEthiopian(t){const e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();if(10===a&&n>=5&&n<=14&&1582===e)throw new Error("Invalid Date between 5-14 May 1582.");const i=[0,31,28,31,30,31,30,31,31,30,31,30,31],s=[0,30,30,30,30,30,30,30,30,30,5,30,30,30,30];(e%4==0&&e%100!=0||e%400==0)&&(i[2]=29);let r=e-8;r%4==3&&(s[10]=6);const o=this._startDayOfEthiopian(e-8);let h=0;for(let t=1;t<a;t++)h+=i[t];h+=n;let c,l,d=r%4==0?26:25;for(e<1582||h<=277&&1582===e?(s[1]=0,s[2]=d):(d=o-3,s[1]=d),c=1;c<s.length;c++){if(h<=s[c]){l=1===c||0===s[c]?h+(30-d):h;break}h-=s[c]}c>10&&(r+=1);return{year:r,month:[0,4,5,6,7,8,9,10,11,12,13,1,2,3,4][c],day:l}}toGregorian(t,e,a){const n=this._startDayOfEthiopian(t);let i=t+7,s=[0,30,31,30,31,31,28,31,30,31,30,31,31,30];const r=i+1;(r%4==0&&r%100!=0||r%400==0)&&(s[6]=29);let o=30*(e-1)+a;o<=37&&t<=1575?(o+=28,s[0]=31):o+=n-1,(t-1)%4==3&&(o+=1);let h,c=0;for(let t=0;t<s.length;t++){if(o<=s[t]){c=t,h=o;break}c=t,o-=s[t]}c>4&&(i+=1);return new Date(i,[8,9,10,11,12,1,2,3,4,5,6,7,8,9][c]-1,h)}getDaysInMonth(t,e){return e<13?30:this.isLeapYear(t)?6:5}isLeapYear(t){return t%4==3}getDayOfWeek(t,e,a){return this.toGregorian(t,e,a).getDay()}getMonthName(t,e=!1){return(e?this.monthNamesAmharic:this.monthNames)[t-1]||""}getDayName(t,e=!1){return(e?this.dayNamesAmharic:this.dayNames)[t]||""}toEthiopicNumeral(t){if(0===t)return"0";const e={1:"፩",2:"፪",3:"፫",4:"፬",5:"፭",6:"፮",7:"፯",8:"፰",9:"፱",10:"፲",20:"፳",30:"፴",40:"፵",50:"፶",60:"፷",70:"፸",80:"፹",90:"፺",100:"፻",1e4:"፼"};if(e[t])return e[t];let a="",n=t;if(n<100){const t=10*Math.floor(n/10),i=n%10;return t>0&&(a+=e[t]),i>0&&(a+=e[i]),a}return t.toString().split("").map(t=>e[parseInt(t)]||t).join("")}now(){return this.toEthiopian(new Date)}}exports.EthiopianCalendar=t,exports.EthiopianCalendarUI=class{constructor(e={}){this.calendar=new t,this.options={onSelect:e.onSelect||null,inputElement:e.inputElement||null,initialDate:e.initialDate||new Date,showGregorian:void 0===e.showGregorian||e.showGregorian,useAmharic:void 0===e.useAmharic||e.useAmharic,useEthiopicNumbers:void 0!==e.useEthiopicNumbers&&e.useEthiopicNumbers,mergedView:void 0!==e.mergedView&&e.mergedView,primaryCalendar:e.primaryCalendar||"ethiopian",...e},this.currentEthDate=this.calendar.toEthiopian(this.options.initialDate),this.selectedDate=null,this.popup=null}show(){this.popup?this.popup.style.display="block":(this.popup=this.createPopup(),document.body.appendChild(this.popup),this.positionPopup(),this.render(),this.attachEventListeners())}hide(){this.popup&&(this.popup.style.display="none")}destroy(){this.popup&&(this.popup.remove(),this.popup=null)}createPopup(){const t=document.createElement("div");t.className="ethcal-popup";const e=this.options.useAmharic?"<div>እሁድ</div><div>ሰኞ</div><div>ማክሰኞ</div><div>ረቡዕ</div><div>ሐሙስ</div><div>ዓርብ</div><div>ቅዳሜ</div>":"<div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>";if(this.options.mergedView){const a="ethiopian"===this.options.primaryCalendar;t.innerHTML=`\n        <div class="ethcal-options">\n          <label>\n            <input type="checkbox" class="ethcal-option-amharic" ${this.options.useAmharic?"checked":""}>\n            <span>Use Amharic</span>\n          </label>\n          <label>\n            <input type="checkbox" class="ethcal-option-ethiopic" ${this.options.useEthiopicNumbers?"checked":""}>\n            <span>Ethiopic Numbers</span>\n          </label>\n          <label>\n            <input type="checkbox" class="ethcal-option-primary" ${a?"checked":""}>\n            <span>Ethiopian Primary</span>\n          </label>\n        </div>\n        <div class="ethcal-calendars ethcal-merged">\n          <div class="ethcal-calendar ethcal-merged-calendar">\n            <div class="ethcal-calendar-title">${a?"Ethiopian":"Gregorian"} Calendar (Primary)</div>\n            <div class="ethcal-header">\n              <button class="ethcal-prev-year" aria-label="Previous Year">&laquo;</button>\n              <button class="ethcal-prev-month" aria-label="Previous Month">&lsaquo;</button>\n              <div class="ethcal-current">\n                <span class="ethcal-month-name"></span>\n                <span class="ethcal-year"></span>\n              </div>\n              <button class="ethcal-next-month" aria-label="Next Month">&rsaquo;</button>\n              <button class="ethcal-next-year" aria-label="Next Year">&raquo;</button>\n            </div>\n            <div class="ethcal-weekdays">${e}</div>\n            <div class="ethcal-days ethcal-merged-days"></div>\n          </div>\n        </div>\n        <div class="ethcal-footer">\n          <button class="ethcal-today">Today</button>\n          <button class="ethcal-close">Close</button>\n        </div>\n      `}else t.innerHTML=`\n        <div class="ethcal-options">\n          <label>\n            <input type="checkbox" class="ethcal-option-amharic" ${this.options.useAmharic?"checked":""}>\n            <span>Use Amharic</span>\n          </label>\n          <label>\n            <input type="checkbox" class="ethcal-option-ethiopic" ${this.options.useEthiopicNumbers?"checked":""}>\n            <span>Ethiopic Numbers</span>\n          </label>\n        </div>\n        <div class="ethcal-calendars">\n          <div class="ethcal-calendar ethcal-ethiopian">\n            <div class="ethcal-calendar-title">Ethiopian Calendar</div>\n            <div class="ethcal-header">\n              <button class="ethcal-prev-year" aria-label="Previous Year">&laquo;</button>\n              <button class="ethcal-prev-month" aria-label="Previous Month">&lsaquo;</button>\n              <div class="ethcal-current">\n                <span class="ethcal-month-name"></span>\n                <span class="ethcal-year"></span>\n              </div>\n              <button class="ethcal-next-month" aria-label="Next Month">&rsaquo;</button>\n              <button class="ethcal-next-year" aria-label="Next Year">&raquo;</button>\n            </div>\n            <div class="ethcal-weekdays">${e}</div>\n            <div class="ethcal-days"></div>\n          </div>\n          ${this.options.showGregorian?'\n          <div class="ethcal-calendar ethcal-gregorian">\n            <div class="ethcal-calendar-title">Gregorian Calendar</div>\n            <div class="ethcal-header">\n              <button class="ethcal-greg-prev-year" aria-label="Previous Year">&laquo;</button>\n              <button class="ethcal-greg-prev-month" aria-label="Previous Month">&lsaquo;</button>\n              <div class="ethcal-current">\n                <span class="ethcal-greg-month-name"></span>\n                <span class="ethcal-greg-year"></span>\n              </div>\n              <button class="ethcal-greg-next-month" aria-label="Next Month">&rsaquo;</button>\n              <button class="ethcal-greg-next-year" aria-label="Next Year">&raquo;</button>\n            </div>\n            <div class="ethcal-weekdays">\n              <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>\n            </div>\n            <div class="ethcal-greg-days"></div>\n          </div>\n          ':""}\n        </div>\n        <div class="ethcal-footer">\n          <button class="ethcal-today">Today</button>\n          <button class="ethcal-close">Close</button>\n        </div>\n      `;return t}positionPopup(){if(this.options.inputElement){const t=this.options.inputElement.getBoundingClientRect();this.popup.style.position="absolute",this.popup.style.top=t.bottom+window.scrollY+5+"px",this.popup.style.left=t.left+window.scrollX+"px"}else this.popup.style.position="fixed",this.popup.style.top="50%",this.popup.style.left="50%",this.popup.style.transform="translate(-50%, -50%)"}render(){const{year:t,month:e}=this.currentEthDate;this.popup.querySelector(".ethcal-month-name").textContent=this.calendar.getMonthName(e,this.options.useAmharic);const a=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(t):t;if(this.popup.querySelector(".ethcal-year").textContent=a,this.options.mergedView){const t="ethiopian"===this.options.primaryCalendar,e=this.popup.querySelector(".ethcal-calendar-title");e&&(e.textContent=(t?"Ethiopian":"Gregorian")+" Calendar (Primary)")}this.updateWeekdayNames(),this.options.mergedView?this.renderMergedCalendar():(this.renderDays(),this.options.showGregorian&&this.renderGregorianCalendar())}updateWeekdayNames(){const t=this.options.mergedView?".ethcal-merged-calendar .ethcal-weekdays":".ethcal-ethiopian .ethcal-weekdays",e=this.popup.querySelector(t);e&&(this.options.useAmharic?e.innerHTML="<div>እሁድ</div><div>ሰኞ</div><div>ማክሰኞ</div><div>ረቡዕ</div><div>ሐሙስ</div><div>ዓርብ</div><div>ቅዳሜ</div>":e.innerHTML="<div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>")}renderDays(){const{year:t,month:e}=this.currentEthDate,a=this.popup.querySelector(".ethcal-days");a.innerHTML="";const n=this.calendar.getDaysInMonth(t,e),i=this.calendar.getDayOfWeek(t,e,1);for(let t=0;t<i;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",a.appendChild(t)}for(let i=1;i<=n;i++){const n=document.createElement("div");n.className="ethcal-day";const s=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(i):i;n.textContent=s,n.dataset.day=i,n.dataset.month=e,n.dataset.year=t;const r=this.calendar.now();t===r.year&&e===r.month&&i===r.day&&n.classList.add("ethcal-today-highlight"),this.selectedDate&&t===this.selectedDate.year&&e===this.selectedDate.month&&i===this.selectedDate.day&&n.classList.add("ethcal-selected"),a.appendChild(n)}}renderGregorianCalendar(){const{year:t,month:e}=this.currentEthDate,a=this.calendar.toGregorian(t,e,1),n=a.getFullYear(),i=a.getMonth();this.popup.querySelector(".ethcal-greg-month-name").textContent=["January","February","March","April","May","June","July","August","September","October","November","December"][i],this.popup.querySelector(".ethcal-greg-year").textContent=n;const s=this.popup.querySelector(".ethcal-greg-days");s.innerHTML="";const r=new Date(n,i,1).getDay(),o=new Date(n,i+1,0).getDate();for(let t=0;t<r;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",s.appendChild(t)}const h=new Date;for(let t=1;t<=o;t++){const e=document.createElement("div");if(e.className="ethcal-day ethcal-greg-day",e.textContent=t,e.dataset.day=t,e.dataset.month=i,e.dataset.year=n,n===h.getFullYear()&&i===h.getMonth()&&t===h.getDate()&&e.classList.add("ethcal-today-highlight"),this.selectedDate){const a=this.calendar.toGregorian(this.selectedDate.year,this.selectedDate.month,this.selectedDate.day);n===a.getFullYear()&&i===a.getMonth()&&t===a.getDate()&&e.classList.add("ethcal-selected")}s.appendChild(e)}}renderMergedCalendar(){const{year:t,month:e}=this.currentEthDate,a="ethiopian"===this.options.primaryCalendar,n=this.popup.querySelector(".ethcal-merged-days");if(n.innerHTML="",a){const a=this.calendar.getDaysInMonth(t,e),i=this.calendar.getDayOfWeek(t,e,1);for(let t=0;t<i;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",n.appendChild(t)}const s=this.calendar.now();for(let i=1;i<=a;i++){const a=document.createElement("div");a.className="ethcal-day ethcal-merged-day";const r=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(i):i,o=this.calendar.toGregorian(t,e,i),h=o.getDate();a.innerHTML=`\n          <span class="ethcal-primary-date">${r}</span>\n          <span class="ethcal-secondary-date">${h}</span>\n        `,a.dataset.day=i,a.dataset.month=e,a.dataset.year=t,a.dataset.gregDay=o.getDate(),a.dataset.gregMonth=o.getMonth(),a.dataset.gregYear=o.getFullYear(),t===s.year&&e===s.month&&i===s.day&&a.classList.add("ethcal-today-highlight"),this.selectedDate&&t===this.selectedDate.year&&e===this.selectedDate.month&&i===this.selectedDate.day&&a.classList.add("ethcal-selected"),n.appendChild(a)}}else{const a=this.calendar.toGregorian(t,e,1),i=a.getFullYear(),s=a.getMonth(),r=new Date(i,s,1).getDay(),o=new Date(i,s+1,0).getDate();for(let t=0;t<r;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",n.appendChild(t)}const h=new Date;for(let t=1;t<=o;t++){const e=document.createElement("div");e.className="ethcal-day ethcal-merged-day";const a=t,r=new Date(i,s,t),o=this.calendar.toEthiopian(r),c=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(o.day):o.day;if(e.innerHTML=`\n          <span class="ethcal-primary-date">${a}</span>\n          <span class="ethcal-secondary-date">${c}</span>\n        `,e.dataset.day=o.day,e.dataset.month=o.month,e.dataset.year=o.year,e.dataset.gregDay=t,e.dataset.gregMonth=s,e.dataset.gregYear=i,i===h.getFullYear()&&s===h.getMonth()&&t===h.getDate()&&e.classList.add("ethcal-today-highlight"),this.selectedDate){const a=this.calendar.toGregorian(this.selectedDate.year,this.selectedDate.month,this.selectedDate.day);i===a.getFullYear()&&s===a.getMonth()&&t===a.getDate()&&e.classList.add("ethcal-selected")}n.appendChild(e)}}}attachEventListeners(){this.popup.querySelector(".ethcal-option-amharic").addEventListener("change",t=>{this.options.useAmharic=t.target.checked,this.render()}),this.popup.querySelector(".ethcal-option-ethiopic").addEventListener("change",t=>{this.options.useEthiopicNumbers=t.target.checked,this.render()});const t=this.popup.querySelector(".ethcal-option-primary");t&&t.addEventListener("change",t=>{this.options.primaryCalendar=t.target.checked?"ethiopian":"gregorian",this.render()}),this.popup.querySelector(".ethcal-prev-year").addEventListener("click",()=>{this.currentEthDate.year--,this.render()}),this.popup.querySelector(".ethcal-next-year").addEventListener("click",()=>{this.currentEthDate.year++,this.render()}),this.popup.querySelector(".ethcal-prev-month").addEventListener("click",()=>{this.currentEthDate.month--,this.currentEthDate.month<1&&(this.currentEthDate.month=13,this.currentEthDate.year--),this.render()}),this.popup.querySelector(".ethcal-next-month").addEventListener("click",()=>{this.currentEthDate.month++,this.currentEthDate.month>13&&(this.currentEthDate.month=1,this.currentEthDate.year++),this.render()}),this.options.showGregorian&&!this.options.mergedView&&(this.popup.querySelector(".ethcal-greg-prev-year").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setFullYear(t.getFullYear()-1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-next-year").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setFullYear(t.getFullYear()+1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-prev-month").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setMonth(t.getMonth()-1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-next-month").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setMonth(t.getMonth()+1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-days").addEventListener("click",t=>{if(t.target.classList.contains("ethcal-greg-day")){const e=parseInt(t.target.dataset.day),a=parseInt(t.target.dataset.month),n=parseInt(t.target.dataset.year),i=new Date(n,a,e),s=this.calendar.toEthiopian(i);this.selectedDate=s,this.currentEthDate=s,this.render(),this.options.onSelect&&this.options.onSelect({ethiopian:s,gregorian:i}),this.options.inputElement&&(this.options.inputElement.value=`${s.day}/${s.month}/${s.year}`),this.hide()}}));const e=this.options.mergedView?".ethcal-merged-days":".ethcal-days";this.popup.querySelector(e).addEventListener("click",t=>{if(t.target.closest(".ethcal-day")&&!t.target.closest(".ethcal-empty")){const e=t.target.closest(".ethcal-day"),a=parseInt(e.dataset.day),n=parseInt(e.dataset.month),i=parseInt(e.dataset.year);if(this.selectedDate={year:i,month:n,day:a},this.render(),this.options.onSelect){const t=this.calendar.toGregorian(i,n,a);this.options.onSelect({ethiopian:{year:i,month:n,day:a},gregorian:t})}this.options.inputElement&&(this.options.inputElement.value=`${a}/${n}/${i}`),this.hide()}}),this.popup.querySelector(".ethcal-today").addEventListener("click",()=>{this.currentEthDate=this.calendar.now(),this.render()}),this.popup.querySelector(".ethcal-close").addEventListener("click",()=>{this.hide()}),document.addEventListener("click",t=>{this.popup&&!this.popup.contains(t.target)&&t.target!==this.options.inputElement&&this.hide()})}setDate(t){this.currentEthDate=this.calendar.toEthiopian(t),this.popup&&this.render()}getSelectedDate(){return this.selectedDate}};
//# sourceMappingURL=ethcal-ui.cjs.js.map
