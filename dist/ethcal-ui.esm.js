class e{constructor(){this.monthNames=["Meskerem","Tikimt","Hidar","Tahsas","Tir","Yekatit","Megabit","Miazia","Ginbot","Sene","Hamle","Nehase","Pagume"],this.monthNamesAmharic=["መስከረም","ጥቅምት","ኅዳር","ታኅሣሥ","ጥር","የካቲት","መጋቢት","ሚያዝያ","ግንቦት","ሰኔ","ሐምሌ","ነሐሴ","ጳጉሜን"],this.dayNames=["Ehud","Segno","Maksegno","Erob","Hamus","Arb","Kidame"],this.dayNamesAmharic=["እሁድ","ሰኞ","ማክሰኞ","ረቡዕ","ሐሙስ","ዓርብ","ቅዳሜ"]}_startDayOfEthiopian(e){const t=Math.floor(e/100)-Math.floor(e/400)-4;return(e-1)%4==3?t+1:t}toEthiopian(e){const t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();if(10===a&&n>=5&&n<=14&&1582===t)throw new Error("Invalid Date between 5-14 May 1582.");const i=[0,31,28,31,30,31,30,31,31,30,31,30,31],s=[0,30,30,30,30,30,30,30,30,30,5,30,30,30,30];(t%4==0&&t%100!=0||t%400==0)&&(i[2]=29);let r=t-8;r%4==3&&(s[10]=6);const o=this._startDayOfEthiopian(t-8);let h=0;for(let e=1;e<a;e++)h+=i[e];h+=n;let c,l,d=r%4==0?26:25;for(t<1582||h<=277&&1582===t?(s[1]=0,s[2]=d):(d=o-3,s[1]=d),c=1;c<s.length;c++){if(h<=s[c]){l=1===c||0===s[c]?h+(30-d):h;break}h-=s[c]}c>10&&(r+=1);return{year:r,month:[0,4,5,6,7,8,9,10,11,12,13,1,2,3,4][c],day:l}}toGregorian(e,t,a){const n=this._startDayOfEthiopian(e);let i=e+7,s=[0,30,31,30,31,31,28,31,30,31,30,31,31,30];const r=i+1;(r%4==0&&r%100!=0||r%400==0)&&(s[6]=29);let o=30*(t-1)+a;o<=37&&e<=1575?(o+=28,s[0]=31):o+=n-1,(e-1)%4==3&&(o+=1);let h,c=0;for(let e=0;e<s.length;e++){if(o<=s[e]){c=e,h=o;break}c=e,o-=s[e]}c>4&&(i+=1);return new Date(i,[8,9,10,11,12,1,2,3,4,5,6,7,8,9][c]-1,h)}getDaysInMonth(e,t){return t<13?30:this.isLeapYear(e)?6:5}isLeapYear(e){return e%4==3}getDayOfWeek(e,t,a){return this.toGregorian(e,t,a).getDay()}getMonthName(e,t=!1){return(t?this.monthNamesAmharic:this.monthNames)[e-1]||""}getDayName(e,t=!1){return(t?this.dayNamesAmharic:this.dayNames)[e]||""}toEthiopicNumeral(e){if(0===e)return"0";const t={1:"፩",2:"፪",3:"፫",4:"፬",5:"፭",6:"፮",7:"፯",8:"፰",9:"፱",10:"፲",20:"፳",30:"፴",40:"፵",50:"፶",60:"፷",70:"፸",80:"፹",90:"፺",100:"፻",1e4:"፼"};if(t[e])return t[e];let a="",n=e;if(n<100){const e=10*Math.floor(n/10),i=n%10;return e>0&&(a+=t[e]),i>0&&(a+=t[i]),a}return e.toString().split("").map(e=>t[parseInt(e)]||e).join("")}now(){return this.toEthiopian(new Date)}}class t{constructor(t={}){this.calendar=new e,this.options={onSelect:t.onSelect||null,inputElement:t.inputElement||null,initialDate:t.initialDate||new Date,showGregorian:void 0===t.showGregorian||t.showGregorian,useAmharic:void 0===t.useAmharic||t.useAmharic,useEthiopicNumbers:void 0!==t.useEthiopicNumbers&&t.useEthiopicNumbers,mergedView:void 0!==t.mergedView&&t.mergedView,primaryCalendar:t.primaryCalendar||"ethiopian",...t},this.currentEthDate=this.calendar.toEthiopian(this.options.initialDate),this.selectedDate=null,this.popup=null}show(){this.popup?this.popup.style.display="block":(this.popup=this.createPopup(),document.body.appendChild(this.popup),this.positionPopup(),this.render(),this.attachEventListeners())}hide(){this.popup&&(this.popup.style.display="none")}destroy(){this.popup&&(this.popup.remove(),this.popup=null)}createPopup(){const e=document.createElement("div");e.className="ethcal-popup";const t=this.options.useAmharic?"<div>እሁድ</div><div>ሰኞ</div><div>ማክሰኞ</div><div>ረቡዕ</div><div>ሐሙስ</div><div>ዓርብ</div><div>ቅዳሜ</div>":"<div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>";if(this.options.mergedView){const a="ethiopian"===this.options.primaryCalendar,n=a?"አ-":"Y-",i=a?"ወ-":"M-",s=a?"ወ+":"M+",r=a?"አ+":"Y+";e.innerHTML=`\n        <div class="ethcal-options">\n          <label>\n            <input type="checkbox" class="ethcal-option-amharic" ${this.options.useAmharic?"checked":""}>\n            <span>Use Amharic</span>\n          </label>\n          <label>\n            <input type="checkbox" class="ethcal-option-ethiopic" ${this.options.useEthiopicNumbers?"checked":""}>\n            <span>Ethiopic Numbers</span>\n          </label>\n          <label>\n            <input type="checkbox" class="ethcal-option-primary" ${a?"checked":""}>\n            <span>Ethiopian Primary</span>\n          </label>\n        </div>\n        <div class="ethcal-calendars ethcal-merged">\n          <div class="ethcal-calendar ethcal-merged-calendar">\n            <div class="ethcal-calendar-title">${a?"Ethiopian":"Gregorian"} Calendar (Primary)</div>\n            <div class="ethcal-header">\n              <button class="ethcal-prev-year" aria-label="Previous Year">${n}</button>\n              <button class="ethcal-prev-month" aria-label="Previous Month">${i}</button>\n              <div class="ethcal-current">\n                <div class="ethcal-primary-header">\n                  <span class="ethcal-month-name"></span>\n                  <span class="ethcal-year"></span>\n                </div>\n                <div class="ethcal-secondary-header">\n                  <span class="ethcal-secondary-month"></span>\n                  <span class="ethcal-secondary-year"></span>\n                </div>\n              </div>\n              <button class="ethcal-next-month" aria-label="Next Month">${s}</button>\n              <button class="ethcal-next-year" aria-label="Next Year">${r}</button>\n            </div>\n            <div class="ethcal-weekdays">${t}</div>\n            <div class="ethcal-days ethcal-merged-days"></div>\n          </div>\n        </div>\n        <div class="ethcal-footer">\n          <button class="ethcal-today">Today</button>\n          <button class="ethcal-close">Close</button>\n        </div>\n      `}else e.innerHTML=`\n        <div class="ethcal-options">\n          <label>\n            <input type="checkbox" class="ethcal-option-amharic" ${this.options.useAmharic?"checked":""}>\n            <span>Use Amharic</span>\n          </label>\n          <label>\n            <input type="checkbox" class="ethcal-option-ethiopic" ${this.options.useEthiopicNumbers?"checked":""}>\n            <span>Ethiopic Numbers</span>\n          </label>\n        </div>\n        <div class="ethcal-calendars">\n          <div class="ethcal-calendar ethcal-ethiopian">\n            <div class="ethcal-calendar-title">Ethiopian Calendar</div>\n            <div class="ethcal-header">\n              <button class="ethcal-prev-year" aria-label="Previous Year">አ-</button>\n              <button class="ethcal-prev-month" aria-label="Previous Month">ወ-</button>\n              <div class="ethcal-current">\n                <span class="ethcal-month-name"></span>\n                <span class="ethcal-year"></span>\n              </div>\n              <button class="ethcal-next-month" aria-label="Next Month">ወ+</button>\n              <button class="ethcal-next-year" aria-label="Next Year">አ+</button>\n            </div>\n            <div class="ethcal-weekdays">${t}</div>\n            <div class="ethcal-days"></div>\n          </div>\n          ${this.options.showGregorian?'\n          <div class="ethcal-calendar ethcal-gregorian">\n            <div class="ethcal-calendar-title">Gregorian Calendar</div>\n            <div class="ethcal-header">\n              <button class="ethcal-greg-prev-year" aria-label="Previous Year">Y-</button>\n              <button class="ethcal-greg-prev-month" aria-label="Previous Month">M-</button>\n              <div class="ethcal-current">\n                <span class="ethcal-greg-month-name"></span>\n                <span class="ethcal-greg-year"></span>\n              </div>\n              <button class="ethcal-greg-next-month" aria-label="Next Month">M+</button>\n              <button class="ethcal-greg-next-year" aria-label="Next Year">Y+</button>\n            </div>\n            <div class="ethcal-weekdays">\n              <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>\n            </div>\n            <div class="ethcal-greg-days"></div>\n          </div>\n          ':""}\n        </div>\n        <div class="ethcal-footer">\n          <button class="ethcal-today">Today</button>\n          <button class="ethcal-close">Close</button>\n        </div>\n      `;return e}positionPopup(){if(this.options.inputElement){const e=this.options.inputElement.getBoundingClientRect();this.popup.style.position="absolute",this.popup.style.top=e.bottom+window.scrollY+5+"px",this.popup.style.left=e.left+window.scrollX+"px"}else this.popup.style.position="fixed",this.popup.style.top="50%",this.popup.style.left="50%",this.popup.style.transform="translate(-50%, -50%)"}render(){const{year:e,month:t}=this.currentEthDate;if(this.options.mergedView){const a="ethiopian"===this.options.primaryCalendar,n=a?"አ-":"Y-",i=a?"ወ-":"M-",s=a?"ወ+":"M+",r=a?"አ+":"Y+";if(this.popup.querySelector(".ethcal-prev-year").textContent=n,this.popup.querySelector(".ethcal-prev-month").textContent=i,this.popup.querySelector(".ethcal-next-month").textContent=s,this.popup.querySelector(".ethcal-next-year").textContent=r,a){this.popup.querySelector(".ethcal-month-name").textContent=this.calendar.getMonthName(t,!0),this.popup.querySelector(".ethcal-year").textContent=e;const a=this.calendar.toGregorian(e,t,1),n=this.calendar.getDaysInMonth(e,t),i=this.calendar.toGregorian(e,t,n),s=a.getMonth(),r=a.getFullYear(),o=i.getMonth(),h=i.getFullYear(),c=["January","February","March","April","May","June","July","August","September","October","November","December"];let l=c[s];s!==o&&(l+="/"+c[o]);let d=r.toString();r!==h&&(d+="/"+h),this.popup.querySelector(".ethcal-secondary-month").textContent=l,this.popup.querySelector(".ethcal-secondary-year").textContent=d}else{const a=this.calendar.toGregorian(e,t,1),n=a.getFullYear(),i=a.getMonth(),s=["January","February","March","April","May","June","July","August","September","October","November","December"];this.popup.querySelector(".ethcal-month-name").textContent=s[i],this.popup.querySelector(".ethcal-year").textContent=n;const r=new Date(n,i,1),o=new Date(n,i+1,0),h=this.calendar.toEthiopian(r),c=this.calendar.toEthiopian(o);let l=this.calendar.getMonthName(h.month,!1);h.month!==c.month&&(l+="/"+this.calendar.getMonthName(c.month,!1));let d=h.year.toString();h.year!==c.year&&(d+="/"+c.year),this.popup.querySelector(".ethcal-secondary-month").textContent=l,this.popup.querySelector(".ethcal-secondary-year").textContent=d}const o=this.popup.querySelector(".ethcal-calendar-title");o&&(o.textContent=(a?"Ethiopian":"Gregorian")+" Calendar (Primary)")}else this.popup.querySelector(".ethcal-month-name").textContent=this.calendar.getMonthName(t,this.options.useAmharic),this.popup.querySelector(".ethcal-year").textContent=e;this.updateWeekdayNames(),this.options.mergedView?this.renderMergedCalendar():(this.renderDays(),this.options.showGregorian&&this.renderGregorianCalendar())}updateWeekdayNames(){const e=this.options.mergedView?".ethcal-merged-calendar .ethcal-weekdays":".ethcal-ethiopian .ethcal-weekdays",t=this.popup.querySelector(e);if(t){const e=this.options.mergedView?"ethiopian"===this.options.primaryCalendar:this.options.useAmharic;t.innerHTML=e?"<div>እሁድ</div><div>ሰኞ</div><div>ማክሰኞ</div><div>ረቡዕ</div><div>ሐሙስ</div><div>ዓርብ</div><div>ቅዳሜ</div>":"<div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>"}}renderDays(){const{year:e,month:t}=this.currentEthDate,a=this.popup.querySelector(".ethcal-days");a.innerHTML="";const n=this.calendar.getDaysInMonth(e,t),i=this.calendar.getDayOfWeek(e,t,1);for(let e=0;e<i;e++){const e=document.createElement("div");e.className="ethcal-day ethcal-empty",a.appendChild(e)}for(let i=1;i<=n;i++){const n=document.createElement("div");n.className="ethcal-day";const s=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(i):i;n.textContent=s,n.dataset.day=i,n.dataset.month=t,n.dataset.year=e;const r=this.calendar.now();e===r.year&&t===r.month&&i===r.day&&n.classList.add("ethcal-today-highlight"),this.selectedDate&&e===this.selectedDate.year&&t===this.selectedDate.month&&i===this.selectedDate.day&&n.classList.add("ethcal-selected"),a.appendChild(n)}}renderGregorianCalendar(){const{year:e,month:t}=this.currentEthDate,a=this.calendar.toGregorian(e,t,1),n=a.getFullYear(),i=a.getMonth();this.popup.querySelector(".ethcal-greg-month-name").textContent=["January","February","March","April","May","June","July","August","September","October","November","December"][i],this.popup.querySelector(".ethcal-greg-year").textContent=n;const s=this.popup.querySelector(".ethcal-greg-days");s.innerHTML="";const r=new Date(n,i,1).getDay(),o=new Date(n,i+1,0).getDate();for(let e=0;e<r;e++){const e=document.createElement("div");e.className="ethcal-day ethcal-empty",s.appendChild(e)}const h=new Date;for(let e=1;e<=o;e++){const t=document.createElement("div");if(t.className="ethcal-day ethcal-greg-day",t.textContent=e,t.dataset.day=e,t.dataset.month=i,t.dataset.year=n,n===h.getFullYear()&&i===h.getMonth()&&e===h.getDate()&&t.classList.add("ethcal-today-highlight"),this.selectedDate){const a=this.calendar.toGregorian(this.selectedDate.year,this.selectedDate.month,this.selectedDate.day);n===a.getFullYear()&&i===a.getMonth()&&e===a.getDate()&&t.classList.add("ethcal-selected")}s.appendChild(t)}}renderMergedCalendar(){const{year:e,month:t}=this.currentEthDate,a="ethiopian"===this.options.primaryCalendar,n=this.popup.querySelector(".ethcal-merged-days");if(n.innerHTML="",a){const a=this.calendar.getDaysInMonth(e,t),i=this.calendar.getDayOfWeek(e,t,1);for(let e=0;e<i;e++){const e=document.createElement("div");e.className="ethcal-day ethcal-empty",n.appendChild(e)}const s=this.calendar.now();for(let i=1;i<=a;i++){const a=document.createElement("div");a.className="ethcal-day ethcal-merged-day";const r=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(i):i,o=this.calendar.toGregorian(e,t,i),h=o.getDate();a.innerHTML=`\n          <span class="ethcal-primary-date">${r}</span>\n          <span class="ethcal-secondary-date">${h}</span>\n        `,a.dataset.day=i,a.dataset.month=t,a.dataset.year=e,a.dataset.gregDay=o.getDate(),a.dataset.gregMonth=o.getMonth(),a.dataset.gregYear=o.getFullYear(),e===s.year&&t===s.month&&i===s.day&&a.classList.add("ethcal-today-highlight"),this.selectedDate&&e===this.selectedDate.year&&t===this.selectedDate.month&&i===this.selectedDate.day&&a.classList.add("ethcal-selected"),n.appendChild(a)}}else{const a=this.calendar.toGregorian(e,t,1),i=a.getFullYear(),s=a.getMonth(),r=new Date(i,s,1).getDay(),o=new Date(i,s+1,0).getDate();for(let e=0;e<r;e++){const e=document.createElement("div");e.className="ethcal-day ethcal-empty",n.appendChild(e)}const h=new Date;for(let e=1;e<=o;e++){const t=document.createElement("div");t.className="ethcal-day ethcal-merged-day";const a=e,r=new Date(i,s,e),o=this.calendar.toEthiopian(r),c=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(o.day):o.day;if(t.innerHTML=`\n          <span class="ethcal-primary-date">${a}</span>\n          <span class="ethcal-secondary-date">${c}</span>\n        `,t.dataset.day=o.day,t.dataset.month=o.month,t.dataset.year=o.year,t.dataset.gregDay=e,t.dataset.gregMonth=s,t.dataset.gregYear=i,i===h.getFullYear()&&s===h.getMonth()&&e===h.getDate()&&t.classList.add("ethcal-today-highlight"),this.selectedDate){const a=this.calendar.toGregorian(this.selectedDate.year,this.selectedDate.month,this.selectedDate.day);i===a.getFullYear()&&s===a.getMonth()&&e===a.getDate()&&t.classList.add("ethcal-selected")}n.appendChild(t)}}}attachEventListeners(){this.popup.querySelector(".ethcal-option-amharic").addEventListener("change",e=>{this.options.useAmharic=e.target.checked,this.render()});const e=this.popup.querySelector(".ethcal-option-ethiopic");e&&e.addEventListener("change",e=>{this.options.useEthiopicNumbers=e.target.checked,this.render()});const t=this.popup.querySelector(".ethcal-option-primary");t&&t.addEventListener("change",e=>{this.options.primaryCalendar=e.target.checked?"ethiopian":"gregorian";const t=this.popup;this.popup=this.createPopup(),t.replaceWith(this.popup),this.render(),this.attachEventListeners()}),this.popup.querySelector(".ethcal-prev-year").addEventListener("click",()=>{this.currentEthDate.year--,this.render()}),this.popup.querySelector(".ethcal-next-year").addEventListener("click",()=>{this.currentEthDate.year++,this.render()}),this.popup.querySelector(".ethcal-prev-month").addEventListener("click",()=>{this.currentEthDate.month--,this.currentEthDate.month<1&&(this.currentEthDate.month=13,this.currentEthDate.year--),this.render()}),this.popup.querySelector(".ethcal-next-month").addEventListener("click",()=>{this.currentEthDate.month++,this.currentEthDate.month>13&&(this.currentEthDate.month=1,this.currentEthDate.year++),this.render()}),this.options.showGregorian&&!this.options.mergedView&&(this.popup.querySelector(".ethcal-greg-prev-year").addEventListener("click",()=>{const e=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);e.setFullYear(e.getFullYear()-1),this.currentEthDate=this.calendar.toEthiopian(e),this.render()}),this.popup.querySelector(".ethcal-greg-next-year").addEventListener("click",()=>{const e=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);e.setFullYear(e.getFullYear()+1),this.currentEthDate=this.calendar.toEthiopian(e),this.render()}),this.popup.querySelector(".ethcal-greg-prev-month").addEventListener("click",()=>{const e=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);e.setMonth(e.getMonth()-1),this.currentEthDate=this.calendar.toEthiopian(e),this.render()}),this.popup.querySelector(".ethcal-greg-next-month").addEventListener("click",()=>{const e=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);e.setMonth(e.getMonth()+1),this.currentEthDate=this.calendar.toEthiopian(e),this.render()}),this.popup.querySelector(".ethcal-greg-days").addEventListener("click",e=>{if(e.target.classList.contains("ethcal-greg-day")){const t=parseInt(e.target.dataset.day),a=parseInt(e.target.dataset.month),n=parseInt(e.target.dataset.year),i=new Date(n,a,t),s=this.calendar.toEthiopian(i);this.selectedDate=s,this.currentEthDate=s,this.render(),this.options.onSelect&&this.options.onSelect({ethiopian:s,gregorian:i}),this.options.inputElement&&(this.options.inputElement.value=`${s.day}/${s.month}/${s.year}`),this.hide()}}));const a=this.options.mergedView?".ethcal-merged-days":".ethcal-days";this.popup.querySelector(a).addEventListener("click",e=>{if(e.target.closest(".ethcal-day")&&!e.target.closest(".ethcal-empty")){const t=e.target.closest(".ethcal-day"),a=parseInt(t.dataset.day),n=parseInt(t.dataset.month),i=parseInt(t.dataset.year);if(this.selectedDate={year:i,month:n,day:a},this.render(),this.options.onSelect){const e=this.calendar.toGregorian(i,n,a);this.options.onSelect({ethiopian:{year:i,month:n,day:a},gregorian:e})}this.options.inputElement&&(this.options.inputElement.value=`${a}/${n}/${i}`),this.hide()}}),this.popup.querySelector(".ethcal-today").addEventListener("click",()=>{this.currentEthDate=this.calendar.now(),this.render()}),this.popup.querySelector(".ethcal-close").addEventListener("click",()=>{this.hide()}),document.addEventListener("click",e=>{this.popup&&!this.popup.contains(e.target)&&e.target!==this.options.inputElement&&this.hide()})}setDate(e){this.currentEthDate=this.calendar.toEthiopian(e),this.popup&&this.render()}getSelectedDate(){return this.selectedDate}}export{e as EthiopianCalendar,t as EthiopianCalendarUI};
//# sourceMappingURL=ethcal-ui.esm.js.map
