!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).EthiopianCalendarUI={})}(this,function(t){"use strict";class e{constructor(){this.monthNames=["Meskerem","Tikimt","Hidar","Tahsas","Tir","Yekatit","Megabit","Miazia","Ginbot","Sene","Hamle","Nehase","Pagume"],this.monthNamesAmharic=["መስከረም","ጥቅምት","ኅዳር","ታኅሣሥ","ጥር","የካቲት","መጋቢት","ሚያዝያ","ግንቦት","ሰኔ","ሐምሌ","ነሐሴ","ጳጉሜን"],this.dayNames=["Ehud","Segno","Maksegno","Erob","Hamus","Arb","Kidame"],this.dayNamesAmharic=["እሁድ","ሰኞ","ማክሰኞ","ረቡዕ","ሐሙስ","ዓርብ","ቅዳሜ"]}_startDayOfEthiopian(t){const e=Math.floor(t/100)-Math.floor(t/400)-4;return(t-1)%4==3?e+1:e}toEthiopian(t){const e=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();if(10===a&&n>=5&&n<=14&&1582===e)throw new Error("Invalid Date between 5-14 May 1582.");const s=[0,31,28,31,30,31,30,31,31,30,31,30,31],i=[0,30,30,30,30,30,30,30,30,30,5,30,30,30,30];(e%4==0&&e%100!=0||e%400==0)&&(s[2]=29);let r=e-8;r%4==3&&(i[10]=6);const o=this._startDayOfEthiopian(e-8);let h=0;for(let t=1;t<a;t++)h+=s[t];h+=n;let l,c,d=r%4==0?26:25;for(e<1582||h<=277&&1582===e?(i[1]=0,i[2]=d):(d=o-3,i[1]=d),l=1;l<i.length;l++){if(h<=i[l]){c=1===l||0===i[l]?h+(30-d):h;break}h-=i[l]}l>10&&(r+=1);return{year:r,month:[0,4,5,6,7,8,9,10,11,12,13,1,2,3,4][l],day:c}}toGregorian(t,e,a){const n=this._startDayOfEthiopian(t);let s=t+7,i=[0,30,31,30,31,31,28,31,30,31,30,31,31,30];const r=s+1;(r%4==0&&r%100!=0||r%400==0)&&(i[6]=29);let o=30*(e-1)+a;o<=37&&t<=1575?(o+=28,i[0]=31):o+=n-1,(t-1)%4==3&&(o+=1);let h,l=0;for(let t=0;t<i.length;t++){if(o<=i[t]){l=t,h=o;break}l=t,o-=i[t]}l>4&&(s+=1);return new Date(s,[8,9,10,11,12,1,2,3,4,5,6,7,8,9][l]-1,h)}getDaysInMonth(t,e){return e<13?30:this.isLeapYear(t)?6:5}isLeapYear(t){return t%4==3}getDayOfWeek(t,e,a){return this.toGregorian(t,e,a).getDay()}getMonthName(t,e=!1){return(e?this.monthNamesAmharic:this.monthNames)[t-1]||""}getDayName(t,e=!1){return(e?this.dayNamesAmharic:this.dayNames)[t]||""}toEthiopicNumeral(t){if(0===t)return"0";const e={1:"፩",2:"፪",3:"፫",4:"፬",5:"፭",6:"፮",7:"፯",8:"፰",9:"፱",10:"፲",20:"፳",30:"፴",40:"፵",50:"፶",60:"፷",70:"፸",80:"፹",90:"፺",100:"፻",1e4:"፼"};if(e[t])return e[t];let a="",n=t;if(n<100){const t=10*Math.floor(n/10),s=n%10;return t>0&&(a+=e[t]),s>0&&(a+=e[s]),a}return t.toString().split("").map(t=>e[parseInt(t)]||t).join("")}now(){return this.toEthiopian(new Date)}}t.EthiopianCalendar=e,t.EthiopianCalendarUI=class{constructor(t={}){this.calendar=new e,this.options={onSelect:t.onSelect||null,inputElement:t.inputElement||null,initialDate:t.initialDate||new Date,showGregorian:void 0===t.showGregorian||t.showGregorian,useAmharic:void 0===t.useAmharic||t.useAmharic,useEthiopicNumbers:void 0!==t.useEthiopicNumbers&&t.useEthiopicNumbers,mergedView:void 0!==t.mergedView&&t.mergedView,primaryCalendar:t.primaryCalendar||"ethiopian",...t},this.currentEthDate=this.calendar.toEthiopian(this.options.initialDate),this.selectedDate=null,this.popup=null}show(){this.popup?this.popup.style.display="block":(this.popup=this.createPopup(),document.body.appendChild(this.popup),this.positionPopup(),this.render(),this.attachEventListeners())}hide(){this.popup&&(this.popup.style.display="none")}destroy(){this.popup&&(this.popup.remove(),this.popup=null)}createPopup(){const t=document.createElement("div");t.className="ethcal-popup";const e=this.options.useAmharic?"<div>እሁድ</div><div>ሰኞ</div><div>ማክሰኞ</div><div>ረቡዕ</div><div>ሐሙስ</div><div>ዓርብ</div><div>ቅዳሜ</div>":"<div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>";if(this.options.mergedView){const a="ethiopian"===this.options.primaryCalendar,n=a?"&lt;አ":"&lt;Y",s=a?"&lt;ወ":"&lt;M",i=a?"ወ&gt;":"M&gt;",r=a?"አ&gt;":"Y&gt;";t.innerHTML=`\n        <div class="ethcal-calendars ethcal-merged">\n          <div class="ethcal-calendar ethcal-merged-calendar">\n            <div class="ethcal-header">\n              <button class="ethcal-prev-year" aria-label="Previous Year">${n}</button>\n              <button class="ethcal-prev-month" aria-label="Previous Month">${s}</button>\n              <div class="ethcal-current">\n                <div class="ethcal-primary-header">\n                  <span class="ethcal-month-name"></span>\n                  <span class="ethcal-year"></span>\n                </div>\n                <div class="ethcal-secondary-header">\n                  <span class="ethcal-secondary-month-name"></span>\n                  <span class="ethcal-secondary-year"></span>\n                </div>\n              </div>\n              <button class="ethcal-next-month" aria-label="Next Month">${i}</button>\n              <button class="ethcal-next-year" aria-label="Next Year">${r}</button>\n            </div>\n            <div class="ethcal-weekdays">${e}</div>\n            <div class="ethcal-days ethcal-merged-days"></div>\n          </div>\n        </div>\n        <div class="ethcal-footer">\n          <button class="ethcal-today">Today</button>\n        </div>\n      `}else t.innerHTML=`\n        <div class="ethcal-calendars">\n          <div class="ethcal-calendar ethcal-ethiopian">\n            <div class="ethcal-header">\n              <button class="ethcal-prev-year" aria-label="Previous Year"><አ</button>\n              <button class="ethcal-prev-month" aria-label="Previous Month"><ወ</button>\n              <div class="ethcal-current">\n                <span class="ethcal-month-name"></span>\n                <span class="ethcal-year"></span>\n              </div>\n              <button class="ethcal-next-month" aria-label="Next Month">ወ></button>\n              <button class="ethcal-next-year" aria-label="Next Year">አ></button>\n            </div>\n            <div class="ethcal-weekdays">${e}</div>\n            <div class="ethcal-days"></div>\n          </div>\n          ${this.options.showGregorian?'\n          <div class="ethcal-calendar ethcal-gregorian">\n            <div class="ethcal-header">\n              <button class="ethcal-greg-prev-year" aria-label="Previous Year">&lt;Y</button>\n              <button class="ethcal-greg-prev-month" aria-label="Previous Month">&lt;M</button>\n              <div class="ethcal-current">\n                <span class="ethcal-greg-month-name"></span>\n                <span class="ethcal-greg-year"></span>\n              </div>\n              <button class="ethcal-greg-next-month" aria-label="Next Month">M&gt;</button>\n              <button class="ethcal-greg-next-year" aria-label="Next Year">Y&gt;</button>\n            </div>\n            <div class="ethcal-weekdays">\n              <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>\n            </div>\n            <div class="ethcal-greg-days"></div>\n          </div>\n          ':""}\n        </div>\n        <div class="ethcal-footer">\n          <button class="ethcal-today">Today</button>\n        </div>\n      `;return t}positionPopup(){if(this.options.inputElement){const t=this.options.inputElement.getBoundingClientRect();this.popup.style.position="absolute",this.popup.style.top=t.bottom+window.scrollY+5+"px",this.popup.style.left=t.left+window.scrollX+"px"}else this.popup.style.position="fixed",this.popup.style.top="50%",this.popup.style.left="50%",this.popup.style.transform="translate(-50%, -50%)"}render(){const{year:t,month:e}=this.currentEthDate;if(this.options.mergedView){const a="ethiopian"===this.options.primaryCalendar,n=a?"<አ":"<Y",s=a?"<ወ":"<M",i=a?"ወ>":"M>",r=a?"አ>":"Y>";this.popup.querySelector(".ethcal-prev-year").textContent=n,this.popup.querySelector(".ethcal-prev-month").textContent=s,this.popup.querySelector(".ethcal-next-month").textContent=i,this.popup.querySelector(".ethcal-next-year").textContent=r;const o=["January","February","March","April","May","June","July","August","September","October","November","December"];if(a){const a=this.calendar.getMonthName(e,!0),n=t;this.popup.querySelector(".ethcal-month-name").textContent=a,this.popup.querySelector(".ethcal-year").textContent=n;const s=this.getSecondaryMonthRange(t,e,!0);let i="";if(s.isSameMonth)i=`${o[s.startMonth]} ${s.startYear}`;else{const t=o[s.startMonth],e=o[s.endMonth];i=s.startYear===s.endYear?`${t} - ${e} ${s.startYear}`:`${t} ${s.startYear} - ${e} ${s.endYear}`}this.popup.querySelector(".ethcal-secondary-month-name").textContent=i,this.popup.querySelector(".ethcal-secondary-year").textContent=""}else{const a=this.calendar.toGregorian(t,e,1),n=a.getFullYear(),s=a.getMonth();this.popup.querySelector(".ethcal-month-name").textContent=o[s],this.popup.querySelector(".ethcal-year").textContent=n;const i=this.getSecondaryMonthRange(n,s,!1);let r="";if(i.isSameMonth){r=`${this.calendar.getMonthName(i.startMonth,!0)} ${i.startYear}`}else{const t=this.calendar.getMonthName(i.startMonth,!0),e=this.calendar.getMonthName(i.endMonth,!0);r=i.startYear===i.endYear?`${t} - ${e} ${i.startYear}`:`${t} ${i.startYear} - ${e} ${i.endYear}`}this.popup.querySelector(".ethcal-secondary-month-name").textContent=r,this.popup.querySelector(".ethcal-secondary-year").textContent=""}const h=this.popup.querySelector(".ethcal-calendar-title");h&&(h.textContent=(a?"Ethiopian":"Gregorian")+" Calendar (Primary)")}else this.popup.querySelector(".ethcal-month-name").textContent=this.calendar.getMonthName(e,this.options.useAmharic),this.popup.querySelector(".ethcal-year").textContent=t;this.updateWeekdayNames(),this.options.mergedView?this.renderMergedCalendar():(this.renderDays(),this.options.showGregorian&&this.renderGregorianCalendar())}updateWeekdayNames(){const t=this.options.mergedView?".ethcal-merged-calendar .ethcal-weekdays":".ethcal-ethiopian .ethcal-weekdays",e=this.popup.querySelector(t);if(e){const t=this.options.mergedView?"ethiopian"===this.options.primaryCalendar:this.options.useAmharic;e.innerHTML=t?"<div>እሁድ</div><div>ሰኞ</div><div>ማክሰኞ</div><div>ረቡዕ</div><div>ሐሙስ</div><div>ዓርብ</div><div>ቅዳሜ</div>":"<div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>"}}renderDays(){const{year:t,month:e}=this.currentEthDate,a=this.popup.querySelector(".ethcal-days");a.innerHTML="";const n=this.calendar.getDaysInMonth(t,e),s=this.calendar.getDayOfWeek(t,e,1);for(let t=0;t<s;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",a.appendChild(t)}for(let s=1;s<=n;s++){const n=document.createElement("div");n.className="ethcal-day";const i=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(s):s;n.textContent=i,n.dataset.day=s,n.dataset.month=e,n.dataset.year=t;const r=this.calendar.now();t===r.year&&e===r.month&&s===r.day&&n.classList.add("ethcal-today-highlight"),this.selectedDate&&t===this.selectedDate.year&&e===this.selectedDate.month&&s===this.selectedDate.day&&n.classList.add("ethcal-selected"),a.appendChild(n)}}renderGregorianCalendar(){const{year:t,month:e}=this.currentEthDate,a=this.calendar.toGregorian(t,e,1),n=a.getFullYear(),s=a.getMonth();this.popup.querySelector(".ethcal-greg-month-name").textContent=["January","February","March","April","May","June","July","August","September","October","November","December"][s],this.popup.querySelector(".ethcal-greg-year").textContent=n;const i=this.popup.querySelector(".ethcal-greg-days");i.innerHTML="";const r=new Date(n,s,1).getDay(),o=new Date(n,s+1,0).getDate();for(let t=0;t<r;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",i.appendChild(t)}const h=new Date;for(let t=1;t<=o;t++){const e=document.createElement("div");if(e.className="ethcal-day ethcal-greg-day",e.textContent=t,e.dataset.day=t,e.dataset.month=s,e.dataset.year=n,n===h.getFullYear()&&s===h.getMonth()&&t===h.getDate()&&e.classList.add("ethcal-today-highlight"),this.selectedDate){const a=this.calendar.toGregorian(this.selectedDate.year,this.selectedDate.month,this.selectedDate.day);n===a.getFullYear()&&s===a.getMonth()&&t===a.getDate()&&e.classList.add("ethcal-selected")}i.appendChild(e)}}getSecondaryMonthRange(t,e,a){if(a){const a=this.calendar.toGregorian(t,e,1),n=this.calendar.getDaysInMonth(t,e),s=this.calendar.toGregorian(t,e,n),i=a.getMonth(),r=a.getFullYear(),o=s.getMonth(),h=s.getFullYear();return{startMonth:i,startYear:r,endMonth:o,endYear:h,isSameMonth:i===o&&r===h}}{const a=new Date(t,e,1),n=new Date(t,e+1,0),s=this.calendar.toEthiopian(a),i=this.calendar.toEthiopian(n);return{startMonth:s.month,startYear:s.year,endMonth:i.month,endYear:i.year,isSameMonth:s.month===i.month&&s.year===i.year}}}renderMergedCalendar(){const{year:t,month:e}=this.currentEthDate,a="ethiopian"===this.options.primaryCalendar,n=this.popup.querySelector(".ethcal-merged-days");if(n.innerHTML="",a){const a=this.calendar.getDaysInMonth(t,e),s=this.calendar.getDayOfWeek(t,e,1);for(let t=0;t<s;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",n.appendChild(t)}const i=this.calendar.now();for(let s=1;s<=a;s++){const a=document.createElement("div");a.className="ethcal-day ethcal-merged-day";const r=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(s):s,o=this.calendar.toGregorian(t,e,s),h=o.getDate();a.innerHTML=`\n          <span class="ethcal-primary-date">${r}</span>\n          <span class="ethcal-secondary-date">${h}</span>\n        `,a.dataset.day=s,a.dataset.month=e,a.dataset.year=t,a.dataset.gregDay=o.getDate(),a.dataset.gregMonth=o.getMonth(),a.dataset.gregYear=o.getFullYear(),t===i.year&&e===i.month&&s===i.day&&a.classList.add("ethcal-today-highlight"),this.selectedDate&&t===this.selectedDate.year&&e===this.selectedDate.month&&s===this.selectedDate.day&&a.classList.add("ethcal-selected"),n.appendChild(a)}}else{const a=this.calendar.toGregorian(t,e,1),s=a.getFullYear(),i=a.getMonth(),r=new Date(s,i,1).getDay(),o=new Date(s,i+1,0).getDate();for(let t=0;t<r;t++){const t=document.createElement("div");t.className="ethcal-day ethcal-empty",n.appendChild(t)}const h=new Date;for(let t=1;t<=o;t++){const e=document.createElement("div");e.className="ethcal-day ethcal-merged-day";const a=t,r=new Date(s,i,t),o=this.calendar.toEthiopian(r),l=this.options.useEthiopicNumbers?this.calendar.toEthiopicNumeral(o.day):o.day;if(e.innerHTML=`\n          <span class="ethcal-primary-date">${a}</span>\n          <span class="ethcal-secondary-date">${l}</span>\n        `,e.dataset.day=o.day,e.dataset.month=o.month,e.dataset.year=o.year,e.dataset.gregDay=t,e.dataset.gregMonth=i,e.dataset.gregYear=s,s===h.getFullYear()&&i===h.getMonth()&&t===h.getDate()&&e.classList.add("ethcal-today-highlight"),this.selectedDate){const a=this.calendar.toGregorian(this.selectedDate.year,this.selectedDate.month,this.selectedDate.day);s===a.getFullYear()&&i===a.getMonth()&&t===a.getDate()&&e.classList.add("ethcal-selected")}n.appendChild(e)}}}attachEventListeners(){this.popup.querySelector(".ethcal-prev-year").addEventListener("click",()=>{this.currentEthDate.year--,this.render()}),this.popup.querySelector(".ethcal-next-year").addEventListener("click",()=>{this.currentEthDate.year++,this.render()}),this.popup.querySelector(".ethcal-prev-month").addEventListener("click",()=>{this.currentEthDate.month--,this.currentEthDate.month<1&&(this.currentEthDate.month=13,this.currentEthDate.year--),this.render()}),this.popup.querySelector(".ethcal-next-month").addEventListener("click",()=>{this.currentEthDate.month++,this.currentEthDate.month>13&&(this.currentEthDate.month=1,this.currentEthDate.year++),this.render()}),this.options.showGregorian&&!this.options.mergedView&&(this.popup.querySelector(".ethcal-greg-prev-year").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setFullYear(t.getFullYear()-1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-next-year").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setFullYear(t.getFullYear()+1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-prev-month").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setMonth(t.getMonth()-1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-next-month").addEventListener("click",()=>{const t=this.calendar.toGregorian(this.currentEthDate.year,this.currentEthDate.month,15);t.setMonth(t.getMonth()+1),this.currentEthDate=this.calendar.toEthiopian(t),this.render()}),this.popup.querySelector(".ethcal-greg-days").addEventListener("click",t=>{if(t.target.classList.contains("ethcal-greg-day")){const e=parseInt(t.target.dataset.day),a=parseInt(t.target.dataset.month),n=parseInt(t.target.dataset.year),s=new Date(n,a,e),i=this.calendar.toEthiopian(s);this.selectedDate=i,this.currentEthDate=i,this.render(),this.options.onSelect&&this.options.onSelect({ethiopian:i,gregorian:s}),this.options.inputElement&&(this.options.inputElement.value=`${i.day}/${i.month}/${i.year}`),this.hide()}}));const t=this.options.mergedView?".ethcal-merged-days":".ethcal-days";this.popup.querySelector(t).addEventListener("click",t=>{if(t.target.closest(".ethcal-day")&&!t.target.closest(".ethcal-empty")){const e=t.target.closest(".ethcal-day"),a=parseInt(e.dataset.day),n=parseInt(e.dataset.month),s=parseInt(e.dataset.year);if(this.selectedDate={year:s,month:n,day:a},this.render(),this.options.onSelect){const t=this.calendar.toGregorian(s,n,a);this.options.onSelect({ethiopian:{year:s,month:n,day:a},gregorian:t})}this.options.inputElement&&(this.options.inputElement.value=`${a}/${n}/${s}`),this.hide()}}),this.popup.querySelector(".ethcal-today").addEventListener("click",()=>{this.currentEthDate=this.calendar.now(),this.render()}),document.addEventListener("click",t=>{this.popup&&!this.popup.contains(t.target)&&t.target!==this.options.inputElement&&this.hide()})}setDate(t){this.currentEthDate=this.calendar.toEthiopian(t),this.popup&&this.render()}getSelectedDate(){return this.selectedDate}}});
//# sourceMappingURL=ethcal-ui.umd.js.map
